<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Rate Images - {{ app_name }}</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.svg') }}" type="image/svg+xml">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/variables.css') + '?v=2' }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') + '?v=2' }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components-bundle.css') + '?v=1' }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') + '?v=4' }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/page-layout.css') + '?v=2' }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/rating-modern.css') + '?v=3' }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap"
        rel="stylesheet">

</head>

<body class="gallery-page">
    {% include 'header.html' %}

    <div class="page-container">
        <!-- Page Header -->
        <div class="page-header rate-review-header">
            <div class="page-header-left">
                <h1 class="page-title">
                    <span class="page-title-icon">‚ú®</span>
                    Rate Images
                </h1>
            </div>
            <div class="page-header-right">
                <button class="action-btn action-btn-secondary" onclick="shuffleImages()">
                    <span>üîÄ</span>
                    Shuffle
                </button>
            </div>
        </div>

        <!-- Filter Pills -->
        <div class="rate-filter-pills">
            <label class="rate-filter-pill">
                <input type="radio" name="filter" value="unrated" checked id="filterUnrated" onchange="changeFilter()">
                <span>‚ùì Unrated</span>
            </label>
            <label class="rate-filter-pill">
                <input type="radio" name="filter" value="ai_predicted" id="filterAI" onchange="changeFilter()">
                <span>ü§ñ AI-Predicted</span>
            </label>
            <label class="rate-filter-pill">
                <input type="radio" name="filter" value="all" id="filterAll" onchange="changeFilter()">
                <span>üìã All Images</span>
            </label>
        </div>

        <!-- Main Image Display -->
        <div class="rate-image-display-wrapper">
            <!-- AI Suggestion Badge (hidden by default) -->
            <div class="ai-suggestion-badge" id="aiSuggestion" style="display: none;">
                <span>ü§ñ</span>
                <span id="aiSuggestionText">AI suggests: General</span>
            </div>

            <!-- Confidence Bar (hidden by default) -->
            <div class="confidence-bar-overlay" id="confidenceBar" style="display: none;">
                <div class="confidence-bar-header">
                    <span>Confidence</span>
                    <span id="confidenceValue" class="confidence-value">0%</span>
                </div>
                <div class="confidence-bar-bg">
                    <div id="confidenceFill" class="confidence-bar-fill"></div>
                </div>
            </div>

            <!-- Image container -->
            <div class="image-display-container" id="imageDisplay">
                <div id="loadingState" class="rate-loading-state">
                    Loading images...
                </div>
            </div>
        </div>

        <!-- Rating Controls -->
        <div class="rate-controls-wrapper">
            <div class="rating-controls-grid">
                <button class="rating-btn general" onclick="setRating('rating:general', 1)">
                    <span class="rating-btn-label">General</span>
                    <span class="rating-shortcut">Press <kbd>1</kbd></span>
                </button>
                <button class="rating-btn sensitive" onclick="setRating('rating:sensitive', 2)">
                    <span class="rating-btn-label">Sensitive</span>
                    <span class="rating-shortcut">Press <kbd>2</kbd></span>
                </button>
                <button class="rating-btn questionable" onclick="setRating('rating:questionable', 3)">
                    <span class="rating-btn-label">Questionable</span>
                    <span class="rating-shortcut">Press <kbd>3</kbd></span>
                </button>
                <button class="rating-btn explicit" onclick="setRating('rating:explicit', 4)">
                    <span class="rating-btn-label">Explicit</span>
                    <span class="rating-shortcut">Press <kbd>4</kbd></span>
                </button>
            </div>

            <!-- Navigation -->
            <div class="nav-controls">
                <button class="btn btn-secondary" onclick="previousImage()">
                    <span>‚Üê</span>
                    Previous
                    <span class="nav-shortcut"><kbd>P</kbd></span>
                </button>
                <button class="btn btn-warning" onclick="skipImage()">
                    <span>‚è≠Ô∏è</span>
                    Skip
                    <span class="nav-shortcut"><kbd>S</kbd></span>
                </button>
                <button class="btn btn-secondary" onclick="nextImage()">
                    Next
                    <span>‚Üí</span>
                    <span class="nav-shortcut"><kbd>N</kbd></span>
                </button>
            </div>

            <!-- Image Tags (Collapsible) - Hidden -->
            <div class="panel rate-tags-panel" style="display: none;">
                <div class="rate-tags-header" onclick="toggleTags()">
                    <h3 class="rate-tags-title">
                        Image Tags
                        <span id="tagCount" class="rate-tags-count">(0 tags)</span>
                    </h3>
                    <span id="tagsToggleIcon" class="rate-tags-toggle-icon">‚ñº</span>
                </div>
                <div id="imageTags" class="rate-tags-content">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Footer Status Bar -->
        <div class="page-footer rate-review-footer">
            <div class="page-footer-left">
                <span id="footerStatus" class="page-footer-item">Ready</span>
            </div>
            <div class="page-footer-shortcuts">
                <span class="shortcut"><span class="shortcut-key">1-4</span> Rate</span>
                <span class="shortcut"><span class="shortcut-key">‚Üê ‚Üí</span> Navigate</span>
                <span class="shortcut"><span class="shortcut-key">S</span> Skip</span>
                <span class="shortcut"><span class="shortcut-key">T</span> Toggle Tags</span>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/modal.js') }}"></script>
    <script src="{{ url_for('static', filename='js/header.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/pages/rate-review.js') }}"></script>
    <script type="module">
        import { showNotification } from "{{ url_for('static', filename='js/utils/notifications.js') }}";
        window.showNotification = showNotification;
    </script>
</body>

</html>