<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ app_name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/shared.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/system-panel.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tags.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/global-uploader.css') }}">
</head>
<body>
    <div id="global-drop-zone" class="global-drop-zone">
        <div class="drop-zone-content">
            <div class="drop-zone-icon">ðŸ“¤</div>
            <div class="drop-zone-text">Drop images to upload</div>
        </div>
    </div>

    {% include 'header.html' %}

    <div class="container">
        <div class="tags-browser-header">
            <h2>Tag Browser</h2>
            <input type="text" id="tagSearchInput" placeholder="Search for tags...">
        </div>

        <div class="category-filter-bar">
            {% set category_counts = {} %}
            {% for tag in all_tags %}
                {% if category_counts.update({tag.category: category_counts.get(tag.category, 0) + 1}) %}{% endif %}
            {% endfor %}

            <button class="category-filter-btn active" data-category="all">
                All <span class="category-count">({{ all_tags|length }})</span>
            </button>
            <button class="category-filter-btn character" data-category="character">
                Character <span class="category-count">({{ category_counts.get('character', 0) }})</span>
            </button>
            <button class="category-filter-btn copyright" data-category="copyright">
                Copyright <span class="category-count">({{ category_counts.get('copyright', 0) }})</span>
            </button>
            <button class="category-filter-btn artist" data-category="artist">
                Artist <span class="category-count">({{ category_counts.get('artist', 0) }})</span>
            </button>
            <button class="category-filter-btn species" data-category="species">
                Species <span class="category-count">({{ category_counts.get('species', 0) }})</span>
            </button>
            <button class="category-filter-btn meta" data-category="meta">
                Meta <span class="category-count">({{ category_counts.get('meta', 0) }})</span>
            </button>
            <button class="category-filter-btn general" data-category="general">
                General <span class="category-count">({{ category_counts.get('general', 0) }})</span>
            </button>
        </div>

        <div class="visible-count-display" id="visibleTagCount">
            Loading tags...
        </div>

        <div class="tags-list-container" id="tagsListContainer">
            <!-- Tags will be loaded dynamically via JavaScript -->
        </div>

        <div class="loading-indicator" id="loadingIndicator" style="display: none; text-align: center; padding: 20px; color: #888;">
            Loading more tags...
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/header.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tags.js') }}"></script>
    <script src="{{ url_for('static', filename='js/system-panel.js') }}"></script>
    <script src="{{ url_for('static', filename='js/global-uploader.js') }}"></script>
</body>
</html>